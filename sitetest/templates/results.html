<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>{% if full %}Full{% else %}Basic{% endif %} Site Test Results for {{site.title}}</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
		<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
		<style>
			.nav-tabs{
				margin-bottom:15px;
			}
			ul, li{
				list-style-type: none;
			}
			h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
				line-height: 1.5em;
			}
			.fa:hover{
				text-decoration: none;
			}
			ul{
				padding-left:0px;
			}
			.image-row{
				width:100%;
				overflow:hidden;
				border-top:1px solid #ccc;
				padding-top:10px;
			}
			.image-cell{
				float:left;
				width:25%;
			}
			.image-cell img{
				width:90%;
				max-width:100%;
				margin:auto;
			}
			.image-cell p{
				-ms-word-break: break-all;
				word-break: break-all;
				word-break: break-word;
				-webkit-hyphens: auto;
				-moz-hyphens: auto;
				hyphens: auto;
			}
			.toplink{
				position: fixed;
				right:20px;
				bottom:20px;
			}
			.panel-title .pull-right > span{
				margin-right:10px;
			}
			.score-low{
				color:#d9534f;
			}
			.score-medium-low{
				color: #eea236;
			}
			.score-medium{
				color: #5bc0de;
			}
			.score-medium-high{
				color: #337ab7;
			}
			.score-high{
				color: #5cb85c;
			}
			
		</style>

		<link rel="icon" type="image/png" href="{{site.url}}/favicon.ico">

		<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
		
		<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

		<script>
		
		</script>
	</head>
	<body>



		<div class="container">
			<h1 id="top">{% if full %}Full{% else %}Basic{% endif %} Site Test Results for &ldquo;{{site.title}}&rdquo;</h1>
			<p>Test took {{duration.seconds}} seconds, starting on {{start_time.strftime('%b %d, %Y at %I:%M %p')}} and ended at {{end_time.strftime('%I:%M %p')}}</p>
			<p>{{set.parsed_links|length}} links were parsed, {{set.loaded_links|length}} loaded, {{set.current_links|length}} total.</p>

			{% if set.messages.success|length > 0 %}
			<section>
				<h3 style="display:none">Success</h3>
				<ul >
					{% for message in set.messages.success %}
					<li class="alert alert-success" role="alert">{{message.message}}</li>		        				
					{% endfor %}        		
				</ul>
			</section>
			{% endif %}

			{% if set.messages.error|length > 0 %}
			<section>
				<h3 style="display:none">Errors</h3>
				<ul >
					{% for message in set.messages.error %}
					<li class="alert alert-danger" role="alert">{{message.message}}</li>		        				
					{% endfor %}        		
				</ul>
			</section>
			{% endif %}

			{% if set.messages.warning|length > 0 %}
			<section>
				<h3 style="display:none">Warning</h3>
				<ul >
					{% for message in set.messages.warning %}
					<li class="alert alert-warning" role="alert">{{message.message}}</li>		        				
					{% endfor %}        		
				</ul>
			</section>
			{% endif %}

			{% if set.messages.info|length > 0 %}
			<section>
				<h3 style="display:none">Info</h3>
				<ul >
					{% for message in set.messages.info %}
					<li class="alert alert-info" role="alert">{{message.message}}</li>		        				
					{% endfor %}        		
				</ul>
			</section>
			{% endif %}




			<!-- Nav tabs -->
			<ul class="nav nav-tabs" role="tablist">
			  	<li class="active"><a href="#pages-parsed" role="tab" data-toggle="tab">Parsed Pages</a></li>
			  	<li><a href="#pages-loaded" role="tab" data-toggle="tab">Loaded Pages</a></li>
			  	<li><a href="#pages-other" role="tab" data-toggle="tab">All Other Pages</a></li>
			</ul>

			<div class="tab-content">
			  	<div class="tab-pane active" id="pages-parsed">				  	
				  	<h2>Parsed Pages</h2>					
					<p>
						<button type="button" class="btn btn-default expand-all" style="margin-right:10px;">Expand All <span class="glyphicon glyphicon-arrow-down"></span></button>
						<button type="button" class="btn btn-default collapse-all">Collapse All <span class="glyphicon glyphicon-arrow-up"></span></button>
					</p>

					{% for link_url, link in set.parsed_links|dictsort %}
					{% set loop_index = loop.index %}
					{% include 'result_full.html' with context %}
					{% endfor %}
				</div>
				<div class="tab-pane" id="pages-loaded">
					<h2>Loaded Pages</h2>	

					{% for link_url, link in set.loaded_links|dictsort %}
					{% if link_url not in set.parsed_links %}
					{% set loop_index = loop.index %}
					{% include 'result_loaded.html' with context %}
					{% endif %}
					{% endfor %}
				</div>
				<div class="tab-pane" id="pages-other">
					<h2>All Other Pages</h2>	

					{% for link_url, link in set.current_links|dictsort %}
					{% if link_url not in set.parsed_links and link_url not in set.loaded_links %}
					{% set loop_index = loop.index %}
					{% include 'result_not_loaded.html' with context %}
					{% endif %}
					{% endfor %}	
				</div>		
			</div>

		</div>

		
		<script>
			//console.log("scripts go here")

			$(".collapse-all").bind("click", function(event){
				$('.panel-collapse').removeClass('in');
			})

			$(".expand-all").bind("click", function(event){
				$('.panel-collapse').addClass('in');				
			})

			$(".pagelink").bind("click", function(event){
				var full_link_target = $(this).attr('href')
			
				var link_target = (full_link_target).split("#")[1];
				var parsed_id = "#pages-parsed"
				var loaded_id = "#pages-loaded"
				var other_id = "#pages-other"

				var is_in_parsed = $(parsed_id).find("#"+link_target).length > 0;
				var is_in_loaded = $(loaded_id).find("#"+link_target).length > 0;
				var is_in_other = $(other_id).find("#"+link_target).length > 0;

				var target_tag = is_in_parsed? parsed_id : is_in_loaded? loaded_id : other_id
				$('[href='+target_tag+']').tab('show');			

				var selector = "#"+link_target+" .pull-left a"
				$(selector).trigger("click")
			});
		</script>

	<!-- child of the body tag -->
	<span class="toplink">
		<a href="#top">
			<i class="fa fa-angle-double-up"></i> Back to Top
		</a>
	</span><!-- /top-link-block -->
	</body>
	
</html>
